<!DOCTYPE html>
<html lang="en">
  {% include head.html %}
  <body class="light preload">

    {% include header.html %}

    <div class="project wrapper">

      <div class="project__header col-12">
        <img src="{{ page.header-image }}"/>
      </div>

      <div class="project__blurb rule col-8 col-md-6 col-sm-12">
        <h2>
          {{ page.blurb }}
        </h2>
      </div>

      <div class="project__desc rule col-4 col-md-6 col-sm-12">
        {{ content }}

        {% if page.role[0] %}
          <h3 class="project__desc__item">
            Role
          </h3>
          {% for role in page.role %}
            <h3 class="pill">
              {{ role }}
            </h3>
          {% endfor %}
        {% endif %}

        {% if page.studio.name %}
          <h3 class="project__desc__item">
            Studio
          </h3>
          <a href="{{ page.studio.link }}" target="_blank">
            <h3 class="pill filled hover external">
              {{ page.studio.name }}
            </h3>
          </a>
        {% endif %}

        {% if page.client.name %}
          <h3 class="project__desc__item">
            Client
          </h3>
          <a href="{{ page.client.link }}" target="_blank">
            <h3 class="pill filled hover external">
              {{ page.client.name }}
            </h3>
          </a>
        {% endif %}

        {% if page.press[0].name %}
          <h3 class="project__desc__item">
            Press
          </h3>
          {% for item in page.press %}
            <a href="{{ item.link }}" target="_blank">
              <h3 class="pill filled hover external">
                {{ item.name }}
              </h3>
            </a>
          {% endfor %}
        {% endif %}
      </div>

      {% for block in page.blocks %}
        {% if block.spacer %}
          <div class="project__spacer col-12"></div>
        {% else %}
          <div class="{% if block.text %}project__text {% else %}project__image {% endif %}col-sm-12 col-{% if block.width %}{{ block.width }}{% else %}12{% endif %}{% if block.offset %}-{{ block.offset }}{% endif %}">
            {% if block.text %}
              <p>
                {{ block.text }}
              </p>
            {% elsif block.image contains '.mp4' %}
              <video width="100%" autoplay muted loop>
                <source src="{{ block.image }}" type="video/mp4">
                Your browser does not support the video tag.
              </video>
            {% else %}
              <img src="{{ block.image }}"/>
            {% endif %}
          </div>
        {% endif %}
      {% endfor %}

      {% if page.instagram.size > 1 %}
          <h3 class="instagram__header col-12">
            In the wild
          </h3>
          {% for post in page.instagram %}
            {% if forloop.index == 1 %}
              <div class="instagram col-4-1 col-md-6-1">
            {% else %}
              <div class="instagram col-4  col-md-6">
            {% endif %}
              {{ post }}
            </div>
          {% endfor %}
      {% endif %}


      {% if page.credits %}
        <div class="project__credits col-12">
          <h3>
            Team
          </h3>
          <p>
            {{ page.credits | newline_to_br }}
          </p>
        </div>
      {% endif %}

      <h3 class="project__more col-12 rule">
        More Projects {{page.postion}}
      </h3>

      {% assign projectsToDisplay = 3 %}
      {% assign sorted = site.projects | sort: 'position' %}
      {% assign sortedLength = sorted.size | minus: 1 %}
      {% assign startPosition = page.position | plus: 1 %}
      {% assign moreProjects = sorted | slice: startPosition, sortedLength %}
      {% if moreProjects.size < projectsToDisplay %}
        {% assign additionalProjectCount = projectsToDisplay | minus: moreProjects.size  %}
        {% assign additionalProjects = sorted | slice: 0, additionalProjectCount %}
        {% assign moreProjects = moreProjects | concat: additionalProjects %}
      {% endif %}
      {% assign count = 0 %}
      {% for project in moreProjects %}
        {% if count < projectsToDisplay %}
          <div class="home__thumbnail col-4 col-md-6 col-sm-12">
            <a class="internal" href="{{ project.url }}">
              <div class="home__thumbnail__image">
                <img src="{{ project.thumbnail-image }}"/>
              </div>
            </a>
            <div class="home__thumbnail__info">
              <a class="internal" href="{{ project.url }}">
                <h3 class="pill filled hover">
                  {{ project.title }} {{project.postion}}
                </h3>
              </a>
              {% for category in project.categories limit:1 %}
                <h3 class="pill">
                  {{ category }}
                </h3>
              {% endfor %}
            </div>
          </div>
          {% assign count = count | plus: 1 %}
        {% else %}
          {% break %}
        {% endif %}
      {% endfor %}

    </div>

    {% include footer.html %}

  </body>
</html>
